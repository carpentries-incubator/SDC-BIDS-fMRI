<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Functional Neuroimaging Analysis in Python: Cleaning Confounders in your Data with Nilearn</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/05-data-cleaning-with-nilearn.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Functional Neuroimaging Analysis in Python
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Functional Neuroimaging Analysis in Python
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Functional Neuroimaging Analysis in Python
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 52%" class="percentage">
    52%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 52%" aria-valuenow="52" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/05-data-cleaning-with-nilearn.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-intro-and-preprocessing.html">1. Course Overview and Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-exploring-fmriprep.html">2. Exploring Preprocessed fMRI Data from fMRIPREP</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-basic_image_manipulation.html">3. Introduction to Image Manipulation using Nilearn</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-integrating_functional_data.html">4. Integrating Functional Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Cleaning Confounders in your Data with Nilearn
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#setting-up">Setting up</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-apply-a-parcellation.html">6. Applying Parcellations to Resting State Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-functional-connectivity-analysis.html">7. Functional Connectivity Analysis</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-integrating_functional_data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-apply-a-parcellation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-integrating_functional_data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Integrating
        </a>
        <a class="chapter-link float-end" href="06-apply-a-parcellation.html" rel="next">
          Next: Applying... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Cleaning Confounders in your Data with Nilearn</h1>
        <p>Last updated on 2024-02-17 |
        
        <a href="https://github.com/carpentries-incubator/SDC-BIDS-fMRI/edit/main/episodes/05-data-cleaning-with-nilearn.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we clean the data so that it more closely reflects BOLD
instead of artifacts</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand the motivation behind confound/nuisance regression</li>
<li>Learn how to implement cleaning using nilearn and fmriprep</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width"><p><strong>Movement is the enemy of Neuroimagers</strong></p>
<p>Movement is an important problem that we need to deal with in our
data. In resting state fMRI movement can induce false correlations
between brain regions leading to inaccurate conclusions about brain
connectivity. However, there is a unique problem that resting state fMRI
faces when dealing with movement:</p>
<ul><li>In resting state fMRI, <em>we don’t actually ever see the true
underlying BOLD signal</em>.</li>
</ul><p>This is un-like task-based fMRI where there is an expectation that
we’ll observe a BOLD signal upon event onset - we have some information
about what the true underlying BOLD signal might look like. In order to
deal with the problem of movement in resting state fMRI we need to
<em>model</em> our fMRI signal to be comprised of <strong>true brain
signal</strong> and <strong>motion (confounder) signals</strong>. We can
make estimates about how motion can influence our data then remove it
from the recorded signal; the leftover signal is what we estimate the
BOLD signal to be.</p>
<p>This process of removing motion-based artifacts from our data is
called <strong>confound regression</strong>, which is essentially
fitting a linear model using motion estimates as regressors then
subtracting it out from the signal. Hopefully in this process we get a
<em>closer estimate</em> of what the actual brain-induced BOLD signal
looks like.</p>
<p>In this section we’ll implement confound regression for resting-state
data using nilearn’s high-level functionality.</p>
</section><section id="setting-up"><h2 class="section-heading">Setting up<a class="anchor" aria-label="anchor" href="#setting-up"></a>
</h2>
<hr class="half-width"><p>Let’s load in some modules as we’ve done before</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> nilearn <span class="im">import</span> image <span class="im">as</span> nimg</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> nilearn <span class="im">import</span> plotting <span class="im">as</span> nplot</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="im">import</span> nibabel <span class="im">as</span> nib</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre>
</div>
<div class="section level3">
<h3 id="setting-up-our-motion-estimates">Setting up our Motion Estimates<a class="anchor" aria-label="anchor" href="#setting-up-our-motion-estimates"></a></h3>
<p>The beauty of FMRIPREP is that it estimates a number of
motion-related signals for you and outputs it into:</p>
<p><strong>sub-xxxx_task-xxxx_desc-confounds_timeseries.tsv</strong></p>
<p>This is basically a spreadsheet that has columns related to each
motion estimate type and rows for timepoints. We can view these using a
language-python package called <code>pandas</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>Let’s pick an fMRI file to clean and pull out the confound tsv that
FMRIPREP computed for us:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> bids  <span class="co"># assuming pip install pybids was covered earlier</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>sub <span class="op">=</span> <span class="st">'10788'</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>fmriprep_dir <span class="op">=</span> <span class="st">'../data/ds000030/derivatives/fmriprep/'</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>layout <span class="op">=</span> bids.BIDSLayout(fmriprep_dir,validate<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                        config<span class="op">=</span>[<span class="st">'bids'</span>,<span class="st">'derivatives'</span>])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>func_files <span class="op">=</span> layout.get(subject<span class="op">=</span>sub,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                        datatype<span class="op">=</span><span class="st">'func'</span>, task<span class="op">=</span><span class="st">'rest'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                        desc<span class="op">=</span><span class="st">'preproc'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                        space<span class="op">=</span><span class="st">'MNI152NLin2009cAsym'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                        extension<span class="op">=</span><span class="st">'nii.gz'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                       return_type<span class="op">=</span><span class="st">'file'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>mask_files <span class="op">=</span> layout.get(subject<span class="op">=</span>sub,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                        datatype<span class="op">=</span><span class="st">'func'</span>, task<span class="op">=</span><span class="st">'rest'</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                        desc<span class="op">=</span><span class="st">'brain'</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                        suffix<span class="op">=</span><span class="st">'mask'</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                        space<span class="op">=</span><span class="st">'MNI152NLin2009cAsym'</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                        extension<span class="op">=</span><span class="st">"nii.gz"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>                       return_type<span class="op">=</span><span class="st">'file'</span>)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>confound_files <span class="op">=</span> layout.get(subject<span class="op">=</span>sub,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                            datatype<span class="op">=</span><span class="st">'func'</span>, task<span class="op">=</span><span class="st">'rest'</span>,</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>                            desc<span class="op">=</span><span class="st">'confounds'</span>,</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>                           extension<span class="op">=</span><span class="st">"tsv"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>                           return_type<span class="op">=</span><span class="st">'file'</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>func_file <span class="op">=</span> func_files[<span class="dv">0</span>]</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>mask_file <span class="op">=</span> mask_files[<span class="dv">0</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>confound_file <span class="op">=</span> confound_files[<span class="dv">0</span>]</span></code></pre>
</div>
<p>Using <code>pandas</code> we can read in the confounds.tsv file as a
spreadsheet and display some rows:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#Delimiter is \t --&gt; tsv is a tab-separated spreadsheet</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>confound_df <span class="op">=</span> pd.read_csv(confound_file, delimiter<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Read </span><span class="sc">{</span><span class="bu">len</span>(confound_df.columns)<span class="sc">}</span><span class="ss"> confounder items, each </span><span class="sc">{</span><span class="bu">len</span>(confound_df)<span class="sc">}</span><span class="ss"> TRs."</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="bu">print</span>(confound_df.head)</span></code></pre>
</div>
<p>Each column in this DataFrame <code>confound_df</code> represents a
specific confound variable that is either estimated directly from head
motion during the functional scan or other noise characteristics that
may capture noise (non grey-matter signal for example). Each row
represents values from a TR/sample. So the number of rows in your
<code>confound_df</code> should match the number of TRs you have in the
functional MR data.</p>
<div id="picking-your-confounds" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="picking-your-confounds" class="callout-inner">
<h3 class="callout-title">Picking your Confounds<a class="anchor" aria-label="anchor" href="#picking-your-confounds"></a>
</h3>
<div class="callout-content">
<p>The choice of which confounds to use in functional imaging analysis
is a source of large debate. We recommend that you check out these
sources for a start:</p>
<ol style="list-style-type: decimal"><li><a href="https://www.sciencedirect.com/science/article/pii/S1053811917302288#f0005" class="external-link">https://www.sciencedirect.com/science/article/pii/S1053811917302288#f0005</a></li>
<li>
<a href="https://www.sciencedirect.com/science/article/pii/S1053811917302288" class="external-link">https://www.sciencedirect.com/science/article/pii/S1053811917302288</a>
For now we’re going to replicate the pre-processing (mostly) from the
seminal Yeo1000 17-networks paper: <a href="https://www.ncbi.nlm.nih.gov/pubmed/21653723" class="external-link">https://www.ncbi.nlm.nih.gov/pubmed/21653723</a>
</li>
</ol></div>
</div>
</div>
<hr><div class="section level4">
<h4 id="the-yeo-2011-pre-processing-schema">The Yeo 2011 Pre-processing schema<a class="anchor" aria-label="anchor" href="#the-yeo-2011-pre-processing-schema"></a></h4>
<div class="section level5">
<h5 id="confound-regressors">Confound regressors<a class="anchor" aria-label="anchor" href="#confound-regressors"></a></h5>
<ol style="list-style-type: decimal"><li>6 motion parameters (trans_x, trans_y, trans_z, rot_x, rot_y,
rot_z)</li>
<li>Global signal (global_signal)</li>
<li>Cerebral spinal fluid signal (csf)</li>
<li>White matter signal (white_matter)</li>
</ol><p>This is a total of 9 base confound regressor variables. Finally we
add temporal derivatives of each of these signals as well (1 temporal
derivative for each), the result is 18 confound regressors.</p>
<hr><p><strong>Temporal Derivatives</strong> are the changes in values
across 2 consecutive samples. It represents change in signal over time.
For example, when dealing with the confound variable “X”, which
represents motion along the “trans_x” direction, the temporal derivative
represents <em>velocity in the X direction</em>.</p>
<hr></div>
<div class="section level5">
<h5 id="lowhigh-pass-filtering">Low/High pass filtering<a class="anchor" aria-label="anchor" href="#lowhigh-pass-filtering"></a></h5>
<ol style="list-style-type: decimal"><li>Low pass filtering cutoff: 0.08</li>
<li>High pass filtering cutoff: 0.009</li>
</ol><p>Low pass filters out high frequency signals from our data. fMRI
signals are slow evolving processes, any high frequency signals are
likely due to noise High pass filters out any very low frequency signals
(below 0.009Hz), which may be due to intrinsic scanner instabilities</p>
</div>
<div class="section level5">
<h5 id="drop-dummy-trs">Drop dummy TRs<a class="anchor" aria-label="anchor" href="#drop-dummy-trs"></a></h5>
<p>During the initial stages of a functional scan there is a strong
signal decay artifact, thus the first 4ish or so TRs are very high
intensity signals that don’t reflect the rest of the scan. Therefore we
drop these timepoints.</p>
</div>
<div class="section level5">
<h5 id="censoring-interpolation-leaving-out">Censoring + Interpolation (leaving out)<a class="anchor" aria-label="anchor" href="#censoring-interpolation-leaving-out"></a></h5>
<p>Censoring involves removal and interpolation of high-movement frames
from the fMRI data. Interpolation is typically done using sophisticated
algorithms much like <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3849338/" class="external-link">Power et
al. 2014</a>.</p>
<p><strong>We won’t be using censoring + interpolation since its fairly
complicated and would take up too much time</strong></p>
<hr></div>
</div>
<div class="section level4">
<h4 id="setting-up-confound-variables-for-regression">Setting up Confound variables for regression<a class="anchor" aria-label="anchor" href="#setting-up-confound-variables-for-regression"></a></h4>
<div class="section level5">
<h5 id="computing-temporal-derivatives-for-confound-variables">Computing temporal derivatives for confound variables<a class="anchor" aria-label="anchor" href="#computing-temporal-derivatives-for-confound-variables"></a></h5>
<p>First we’ll select our confound variables from our dataframe. You can
do this by specifying a list of confounds, then using that list to pull
out the associated columns</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Select confounds</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>confound_vars <span class="op">=</span> [<span class="st">'trans_x'</span>,<span class="st">'trans_y'</span>,<span class="st">'trans_z'</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                 <span class="st">'rot_x'</span>,<span class="st">'rot_y'</span>,<span class="st">'rot_z'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                 <span class="st">'global_signal'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                 <span class="st">'csf'</span>, <span class="st">'white_matter'</span>]</span></code></pre>
</div>
<p>Next we need to get derivatives for each of these columns. Luckily
fMRIPrep provides this for us. Derivative columns are denoted as the
following:</p>
<ul><li>{NAME_OF_COLUMN}_derivative1</li>
</ul><p>Since typing is alot of work, we’ll use a for-loop instead to pick
the derivatives for our <code>confound_vars</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Get derivative column names</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>derivative_columns <span class="op">=</span> [<span class="st">'</span><span class="sc">{}</span><span class="st">_derivative1'</span>.<span class="bu">format</span>(c) <span class="cf">for</span> c</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                     <span class="kw">in</span> confound_vars]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="bu">print</span>(derivative_columns)</span></code></pre>
</div>
<p>Now we’ll join these two lists together:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>final_confounds <span class="op">=</span> confound_vars <span class="op">+</span> derivative_columns</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">print</span>(final_confounds)</span></code></pre>
</div>
<p>Finally we’ll use this list to pick columns from our confounds
table</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>confound_df <span class="op">=</span> confound_df[final_confounds]</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>confound_df.head()</span></code></pre>
</div>
<div id="what-the-nan" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-the-nan" class="callout-inner">
<h3 class="callout-title">What the NaN???<a class="anchor" aria-label="anchor" href="#what-the-nan"></a>
</h3>
<div class="callout-content">
<p>As you might have noticed, we have NaN’s in our confound dataframe.
This happens because there is no prior value to the first index to take
a difference with, but this isn’t a problem since we’re going to be
dropping 4 timepoints from our data and confounders anyway!</p>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="dummy-tr-drop">Dummy TR Drop<a class="anchor" aria-label="anchor" href="#dummy-tr-drop"></a></h5>
<p>Now we’ll implement our <strong>Dummy TR Drop</strong>. Remember this
means that we are removing the first 4 timepoints from our functional
image (we’ll also have to do this for our first 4 confound
timepoints!):</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#First we'll load in our data and check the shape</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>raw_func_img <span class="op">=</span> nimg.load_img(func_file)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>raw_func_img.shape</span></code></pre>
</div>
<p>Recall that the fourth dimension represents frames/TRs(timepoints).
We want to drop the first four timepoints entirely, to do so we use
nibabel’s slicer feature. We’ll also drop the first 4 confound variable
timepoints to match the functional scan</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>func_img <span class="op">=</span> raw_func_img.slicer[:,:,:,<span class="dv">4</span>:]</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>func_img.shape</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(65, 77, 49, 148)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#Drop confound dummy TRs</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>drop_confound_df <span class="op">=</span> confound_df.loc[<span class="dv">4</span>:]</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="bu">print</span>(drop_confound_df.shape) <span class="co">#number of rows should match that of the functional image</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>drop_confound_df.head()</span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="applying-confound-regression">Applying confound regression<a class="anchor" aria-label="anchor" href="#applying-confound-regression"></a></h4>
<p>Now we’d like to clean our data of our selected confound variables.
There are two ways to go about this:</p>
<ol style="list-style-type: decimal"><li>If you have nilearn version 0.5.0 or higher use
<code>nilearn.image.clean_img(image,confounds,…)</code>
</li>
<li>If you want full control over specific parts of the image you’re
cleaning use <code>nilearn.signal.clean(signals,confounds,…)</code>
</li>
</ol><p>The first method is probably most practical and can be done in one
line given what we’ve already set-up. However, in cases of very large
datasets (HCP-style), the second method might be preferable for
optimizing memory usage.</p>
<p>First note that both methods take an argument <code>confounds</code>.
This is a matrix:</p>
<figure><img src="fig/matrix.png" class="img-responsive figure mx-auto d-block" alt="Confounds Matrix"></figure><p>Therefore our goal is to take our confound matrix and work it into a
matrix of the form above. The end goal is a matrix with 147 rows, and
columns matching the number of confound variables (9x2=18)</p>
<p>Luckily this is a one-liner!</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>confounds_matrix <span class="op">=</span> drop_confound_df.values</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#Confirm matrix size is correct</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>confounds_matrix.shape</span></code></pre>
</div>
<p>Let’s clean our image!</p>
</div>
</div>
<div class="section level3">
<h3 id="using-nilearn-image-clean_img">Using <code>nilearn.image.clean_img</code>
<a class="anchor" aria-label="anchor" href="#using-nilearn-image-clean_img"></a></h3>
<p>First we’ll describe a couple of this function’s important arguments.
Any argument enclosed in [arg] is optional</p>
<p><code>nilearn.image.clean_img(image,confounds,[low_pass],[high_pass],[t_r],[mask_img],[detrend],[standardize])</code></p>
<p><strong>Required</strong>:</p>
<ul><li>
<code>image</code>: The functional image (<code> func_img
</code>)</li>
<li>
<code>confounds</code>: The confound matrix (<code> confounds
</code>)</li>
</ul><p><strong>Optional</strong>:</p>
<ul><li>
<code>low_pass</code>: A low pass filter cut-off</li>
<li>
<code>high_pass</code> A high pass filter cut-off</li>
<li>
<code>t_r</code>: This is required if using low/high pass, the
repetition time of acquisition (imaging metadata)</li>
<li>
<code>mask_img</code> Apply a mask when performing confound
regression, will speed up regression</li>
<li>
<code>detrend</code>: Remove drift from the data (useful for
removing scanner instability artifacts) [default=True]</li>
<li>
<code>standardize</code>: Set mean to 0, and variance to 1 –&gt;
sets up data for statistical analysis [default=True]</li>
</ul><hr><p><strong>What we’re using</strong>:</p>
<p>The Repetition Time of our data is 2 seconds, in addition since we’re
replicating (mostly) Yeo 2011’s analysis:</p>
<ul><li>high_pass = 0.009</li>
<li>low_pass = 0.08</li>
<li>detrend = True</li>
<li>standardize = True</li>
</ul><p>In addition we’ll use a mask of our MNI transformed functional image
(<code> mask </code>) to speed up cleaning</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co">#Set some constants</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>high_pass<span class="op">=</span> <span class="fl">0.009</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>low_pass <span class="op">=</span> <span class="fl">0.08</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>t_r <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#Clean!</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>clean_img <span class="op">=</span> nimg.clean_img(func_img,confounds<span class="op">=</span>confounds_matrix,detrend<span class="op">=</span><span class="va">True</span>,standardize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                         low_pass<span class="op">=</span>low_pass,high_pass<span class="op">=</span>high_pass,t_r<span class="op">=</span>t_r, mask_img<span class="op">=</span>mask_file)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#Let's visualize our result! Doesn't really tell us much, but that's the data we're using for analysis!</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>nplot.plot_epi(clean_img.slicer[:,:,:,<span class="dv">50</span>])</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>before_figure <span class="op">=</span> nplot.plot_carpet(clean_img, mask, t_r<span class="op">=</span>t_r)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>after_figure <span class="op">=</span> nplot.plot_carpet(func_img, mask, t_r<span class="op">=</span>t_r)</span></code></pre>
</div>
<div class="section level4">
<h4 id="done">Done!<a class="anchor" aria-label="anchor" href="#done"></a></h4>
<p>Hopefully by now you’ve learned what confound regression is, and how
to perform it in nilearn using 2 different methods. We’d like to note
that there are many more methods to perform confound regression
(simultaneous signal extraction + confound regression for example) but
all those methods fundamentally rely on what you’ve done here.</p>
<p>In addition, performing confound regression on <em>functional
volumes</em>, is also not the only way to do data cleaning. More modern
methods involve applying confound regression on <em>functional
surfaces</em>, however, those methods are too advanced for an
introductory course to functional data analysis and involve tools
outside of python.</p>
<p>If you’re interested in surface-based analysis we recommend that you
check out the following sources:</p>
<ol style="list-style-type: decimal"><li><a href="https://edickie.github.io/ciftify/#/" class="external-link">https://edickie.github.io/ciftify/#/</a></li>
<li><a href="https://www.humanconnectome.org/software/connectome-workbench" class="external-link">https://www.humanconnectome.org/software/connectome-workbench</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pubmed/23668970" class="external-link">The minimal
preprocessing pipelines for the Human Connectome Project</a></li>
</ol><hr><p>The section below is <strong>optional</strong> and is a more advanced
dive into the underlying mechanics of how <code>nilearn.clean_img</code>
works:</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Nuisance regression is an attempt to make sure your results aren’t
driven by non-brain signals</li>
<li>With resting state, we don’t actually ever know the true signal - we
can only attempt to estimate it</li>
</ul></div>
</div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-integrating_functional_data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-apply-a-parcellation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-integrating_functional_data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Integrating
        </a>
        <a class="chapter-link float-end" href="06-apply-a-parcellation.html" rel="next">
          Next: Applying... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries-incubator/SDC-BIDS-fMRI/edit/main/episodes/05-data-cleaning-with-nilearn.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries-incubator/SDC-BIDS-fMRI/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/SDC-BIDS-fMRI/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/SDC-BIDS-fMRI/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.3" class="external-link">sandpaper (0.16.3)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.4" class="external-link">pegboard (0.7.4)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/SDC-BIDS-fMRI/05-data-cleaning-with-nilearn.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Cleaning Confounders in your Data with Nilearn",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/SDC-BIDS-fMRI/05-data-cleaning-with-nilearn.html",
  "identifier": "https://carpentries-incubator.github.io/SDC-BIDS-fMRI/05-data-cleaning-with-nilearn.html",
  "dateCreated": "2024-02-18",
  "dateModified": "2024-02-17",
  "datePublished": "2024-04-02"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

